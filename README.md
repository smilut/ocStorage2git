# ocStorage2git
скрипт выгрузки истории разработки из хранилища конфигурации 1С в git

Требования.

База 1С не подключенная к хранилищу конфигураций, для загрузки требуемых версий конфигурации из хранилища. 
Подключенная к хранилищу база позволяет загружать только текущую версию.
База содержит пустую конфигурацию базы данных, никогда основная конфигурация, загруженная из хранилища, 
не сохраняется в конфигурацию базы данных. 
Это необходимо для запуска пустой конфигурации в пакетном режиме и выполнения сервисных обработок.
В конфигурации, которая сохранена в базе данных, должна присутствовать роль ПолныеПрава и пользователь
с этой ролью и отключенной защитой от опасных действий. 
Под этим пользователем будет выполняться обработка парсинга отчета хранилища.
Запуск конфигуратора 1С в пакетном режиме с подключением к созданной в п.1 базе должен выполняться без ошибок.

Ограничения.

При перезаливке конфигурации в хранилище версия хранилища сбрасывается на 1(единицу). 
Что может привести к ошибкам в работе скрипта формирования хронологии в Git.

Сценарий использования, создания истории в Git.

Исходные данные:
	Пустая база 1С. Хранилище с историей разработки.
	
Действия скрипта:

1. Получает  отчет по хранилищу по новой версии, начиная с 1 версии (или с указанной если это не первый запуск)
2. Конвертирует отчет хранилища в json для обработки скриптом.
3. Начинает цикл обработки версий хранилища:
 
-Обновляет базу из хранилища, на минимальную не обработанную версию

-Выгружает файлы конфигурации в папку проекта git, с учетом авторства, даты и комментария к версии хранилища

-Выполняет git add

-Выполняет commit от имени пользователя создавшего версию в хранилище. 
  В качестве описания коммитов для краткости используется комментарий версии, 
  для полного описания список измененных объектов.
  
-Переходит к обработке следующей версии

4. Скрипт завершается либо по ошибке, либо обработав все версии полученные в отчете. 
    Номер, на котором прервалась обработка запоминается, как начальный номер для следующего запуска.
